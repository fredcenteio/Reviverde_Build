import{s as b}from"./chunk-6Z33ZIB3.js";import{D as n,W as o,_ as v,a as u,b as p,da as S,k as h,o as r}from"./chunk-BK3W6Q5I.js";var f=()=>{let l=window.location.hostname;return l==="localhost"||l==="127.0.0.1"?"http://localhost:3000/api":`${window.location.protocol}//${window.location.host}/api`},c=f(),g=class l{NEWS_KEY="reviverde-news";PROJECTS_KEY="reviverde-projects";USERS_KEY="reviverde-users";SERVICES_KEY="reviverde-services";PARTICIPATION_KEY="reviverde-participation";CONTACT_KEY="reviverde-contact";CONTACT_SUBMISSIONS_KEY="reviverde-submissions";IMPACT_KEY="reviverde-impact";http=S(b);newsSubject=new h([]);projectsSubject=new h([]);usersSubject=new h([]);servicesSubject=new h([]);contactSubmissionsSubject=new h([]);news$=this.newsSubject.asObservable();projects$=this.projectsSubject.asObservable();users$=this.usersSubject.asObservable();services$=this.servicesSubject.asObservable();contactSubmissions$=this.contactSubmissionsSubject.asObservable();participationCache=null;contactInfoCache=null;impactStatsCache=null;constructor(){this.loadData()}loadData(){this.loadNews(),this.loadProjects(),this.loadUsers(),this.loadServices(),this.loadContactSubmissions(),this.loadParticipationOptions(),this.loadContactInfo(),this.loadImpactStats()}loadNews(){let e=localStorage.getItem(this.NEWS_KEY);if(e){let t=JSON.parse(e).map(i=>p(u({},i),{date:new Date(i.date)}));this.newsSubject.next(t)}else{let t=[{id:1,title:"ReviVerde Planteia 500 \xC1rvores em Santiago",summary:"A ReviVerde, em parceria com a comunidade local, plantou 500 \xE1rvores frut\xEDferas em Santiago.",content:"Em uma a\xE7\xE3o conjunta com a comunidade de Santiago, a ReviVerde plantou 500 \xE1rvores frut\xEDferas nativas. Esta iniciativa faz parte do programa de refloresta\xE7\xE3o urbana e visa combater as ilhas de calor na cidade.",image:"/barragem_cabo_verde.jpg",date:new Date("2024-09-10"),published:!0,author:"Admin ReviVerde"},{id:2,title:"Workshop de Educa\xE7\xE3o Ambiental nas Escolas",summary:"Realizamos workshops em 10 escolas de Cabo Verde, sensibilizando mais de 500 estudantes.",content:"A ReviVerde realizou workshops de educa\xE7\xE3o ambiental em 10 escolas diferentes de Cabo Verde, alcan\xE7ando mais de 500 estudantes. Os workshops inclu\xEDram atividades pr\xE1ticas de plantio e conscientiza\xE7\xE3o sobre sustentabilidade.",image:"/image1.jpg",date:new Date("2024-08-25"),published:!0,author:"Admin ReviVerde"}];this.newsSubject.next(t),this.saveNews(t)}}getNews(){return this.newsSubject.value}addNews(e){let t=this.getNews(),i=Math.max(...t.map(d=>d.id),0)+1,s=p(u({},e),{id:i}),a=[...t,s];this.newsSubject.next(a),this.saveNews(a)}updateNews(e){let t=this.getNews(),i=t.findIndex(s=>s.id===e.id);i!==-1&&(t[i]=e,this.newsSubject.next([...t]),this.saveNews(t))}deleteNews(e){let i=this.getNews().filter(s=>s.id!==e);this.newsSubject.next(i),this.saveNews(i)}saveNews(e){localStorage.setItem(this.NEWS_KEY,JSON.stringify(e))}loadProjects(){let e=localStorage.getItem(this.PROJECTS_KEY);if(e)this.projectsSubject.next(JSON.parse(e));else{let t=[{id:1,title:"Uma crian\xE7a, uma \xC1rvore",subtitle:"Projeto Educacional",objective:"\u{1F3AF} Objetivo Geral: Promover a educa\xE7\xE3o ambiental entre crian\xE7as atrav\xE9s do plantio e cuidado de uma planta, incentivando a responsabilidade e a consci\xEAncia ecol\xF3gica desde cedo.",target:"\u{1F465} P\xFAblico-Alvo: Uma turma de alunos, professores e eventualmente encarregados de educa\xE7\xE3o.",location:"\u{1F4CD} Local: P\xE1tio escolar ou \xE1rea designada para o jardim escolar.",image:"/image1.jpg",status:"active"},{id:2,title:"Uma Fam\xEDlia, uma planta",subtitle:"Projeto Comunit\xE1rio",objective:"\u{1F3AF} Objetivo Geral: Promover a arboriza\xE7\xE3o comunit\xE1ria e fortalecer o v\xEDnculo das fam\xEDlias com o meio ambiente.",target:"\u{1F465} P\xFAblico-Alvo: Fam\xEDlias da comunidade selecionada e lideran\xE7as comunit\xE1rias.",location:"\u{1F4CD} Local: Quintais das casas ou \xE1reas comuns indicadas pelas fam\xEDlias.",image:"/paisagem_verde.avif",status:"active"}];this.projectsSubject.next(t),this.saveProjects(t)}}getProjects(){return this.projectsSubject.value}addProject(e){let t=this.getProjects(),i=Math.max(...t.map(d=>d.id),0)+1,s=p(u({},e),{id:i}),a=[...t,s];this.projectsSubject.next(a),this.saveProjects(a)}updateProject(e){let t=this.getProjects(),i=t.findIndex(s=>s.id===e.id);i!==-1&&(t[i]=e,this.projectsSubject.next([...t]),this.saveProjects(t))}deleteProject(e){let i=this.getProjects().filter(s=>s.id!==e);this.projectsSubject.next(i),this.saveProjects(i)}saveProjects(e){localStorage.setItem(this.PROJECTS_KEY,JSON.stringify(e))}loadUsers(){let e=localStorage.getItem(this.USERS_KEY);if(e){let t=JSON.parse(e).map(i=>p(u({},i),{createdAt:i.createdAt?new Date(i.createdAt):new Date}));this.usersSubject.next(t)}else{let t=[{id:1,name:"Admin ReviVerde",email:"admin@reviverde.org",role:"admin",active:!0,createdAt:new Date},{id:2,name:"Editor Principal",email:"editor@reviverde.org",role:"editor",active:!0,createdAt:new Date},{id:3,name:"Visualizador",email:"viewer@reviverde.org",role:"viewer",active:!0,createdAt:new Date}];this.usersSubject.next(t),this.saveUsers(t)}}getUsers(){return this.usersSubject.value}addUser(e){let t=this.getUsers(),i=Math.max(...t.map(d=>d.id),0)+1,s=p(u({},e),{id:i}),a=[...t,s];this.usersSubject.next(a),this.saveUsers(a)}updateUser(e){let t=this.getUsers(),i=t.findIndex(s=>s.id===e.id);i!==-1&&(t[i]=e,this.usersSubject.next([...t]),this.saveUsers(t))}deleteUser(e){let i=this.getUsers().filter(s=>s.id!==e);this.usersSubject.next(i),this.saveUsers(i)}saveUsers(e){localStorage.setItem(this.USERS_KEY,JSON.stringify(e))}getContentStats(){return{newsCount:this.getNews().length,projectsCount:this.getProjects().length,usersCount:this.getUsers().length}}loadServices(){let e=localStorage.getItem(this.SERVICES_KEY);e?this.servicesSubject.next(JSON.parse(e)):this.http.get(`${c}/services`).pipe(o(t=>{this.servicesSubject.next(t),this.saveServices(t)}),n(()=>{let t=[];return this.servicesSubject.next(t),this.saveServices(t),r(t)})).subscribe()}getServices(){return this.servicesSubject.value}addService(e){return this.http.post(`${c}/services`,e).pipe(o(t=>{let s=[...this.getServices(),t];this.servicesSubject.next(s),this.saveServices(s)}),n(t=>{let i=this.getServices(),s=Math.max(...i.map(m=>m.id),0)+1,a=p(u({},e),{id:s}),d=[...i,a];return this.servicesSubject.next(d),this.saveServices(d),r(a)}))}updateService(e){return this.http.put(`${c}/services/${e.id}`,e).pipe(o(t=>{let i=this.getServices(),s=i.findIndex(a=>a.id===e.id);s!==-1&&(i[s]=t,this.servicesSubject.next([...i]),this.saveServices(i))}),n(()=>{let t=this.getServices(),i=t.findIndex(s=>s.id===e.id);return i!==-1&&(t[i]=e,this.servicesSubject.next([...t]),this.saveServices(t)),r(e)}))}deleteService(e){return this.http.delete(`${c}/services/${e}`).pipe(o(()=>{let i=this.getServices().filter(s=>s.id!==e);this.servicesSubject.next(i),this.saveServices(i)}),n(()=>{let i=this.getServices().filter(s=>s.id!==e);return this.servicesSubject.next(i),this.saveServices(i),r(void 0)}))}saveServices(e){localStorage.setItem(this.SERVICES_KEY,JSON.stringify(e))}loadParticipationOptions(){let e=localStorage.getItem(this.PARTICIPATION_KEY);e?this.participationCache=JSON.parse(e):this.http.get(`${c}/participation`).pipe(o(t=>{this.participationCache=t,this.persistParticipationOptions(t)}),n(()=>{let t={volunteer:{title:"",description:"",buttonText:""},member:{title:"",description:"",buttonText:""},partnership:{title:"",description:"",buttonText:""}};return this.participationCache=t,this.persistParticipationOptions(t),r(t)})).subscribe()}getParticipationOptions(){return this.participationCache||{volunteer:{title:"",description:"",buttonText:""},member:{title:"",description:"",buttonText:""},partnership:{title:"",description:"",buttonText:""}}}saveParticipationOptions(e){return this.http.post(`${c}/participation`,e).pipe(o(t=>{this.participationCache=t,this.persistParticipationOptions(t)}),n(()=>(localStorage.setItem(this.PARTICIPATION_KEY,JSON.stringify(e)),this.participationCache=e,r(e))))}persistParticipationOptions(e){localStorage.setItem(this.PARTICIPATION_KEY,JSON.stringify(e))}loadContactInfo(){let e=localStorage.getItem(this.CONTACT_KEY);e?this.contactInfoCache=JSON.parse(e):this.http.get(`${c}/contact-info`).pipe(o(t=>{this.contactInfoCache=t,this.saveContactInfo(t)}),n(()=>{let t={phone1:"",phone2:"",email:"",address:"",facebook:"",instagram:"",twitter:"",linkedin:"",formEmail:"",enableFormSubmissions:!0};return this.contactInfoCache=t,this.saveContactInfo(t),r(t)})).subscribe()}getContactInfo(){return this.contactInfoCache||{phone1:"",phone2:"",email:"",address:"",facebook:"",instagram:"",twitter:"",linkedin:"",formEmail:"",enableFormSubmissions:!0}}updateContactInfo(e){return this.http.put(`${c}/contact-info`,e).pipe(o(t=>{this.contactInfoCache=t,this.saveContactInfo(t)}),n(()=>(localStorage.setItem(this.CONTACT_KEY,JSON.stringify(e)),this.contactInfoCache=e,r(e))))}saveContactInfo(e){localStorage.setItem(this.CONTACT_KEY,JSON.stringify(e))}loadContactSubmissions(){let e=localStorage.getItem(this.CONTACT_SUBMISSIONS_KEY);if(e){let t=JSON.parse(e).map(i=>p(u({},i),{date:new Date(i.date)}));this.contactSubmissionsSubject.next(t)}else this.http.get(`${c}/contact-submissions`).pipe(o(t=>{this.contactSubmissionsSubject.next(t),this.saveContactSubmissions(t)}),n(()=>(this.contactSubmissionsSubject.next([]),r([])))).subscribe()}getContactSubmissions(){return this.contactSubmissionsSubject.value}submitContactForm(e){let t=p(u({},e),{date:new Date,read:!1});return this.http.post(`${c}/contact-submissions`,t).pipe(o(i=>{let s=this.getContactSubmissions(),a=[i,...s];this.contactSubmissionsSubject.next(a),this.saveContactSubmissions(a)}),n(()=>{let i=this.getContactSubmissions(),s=Math.max(...i.map(m=>m.id),0)+1,a=p(u({},t),{id:s}),d=[a,...i];return this.contactSubmissionsSubject.next(d),this.saveContactSubmissions(d),r(a)}))}markSubmissionAsRead(e){return this.http.patch(`${c}/contact-submissions/${e}`,{read:!0}).pipe(n(()=>r(void 0)))}saveContactSubmissions(e){localStorage.setItem(this.CONTACT_SUBMISSIONS_KEY,JSON.stringify(e))}loadImpactStats(){let e=localStorage.getItem(this.IMPACT_KEY);e?this.impactStatsCache=JSON.parse(e):this.http.get(`${c}/impact`).pipe(o(t=>{this.impactStatsCache=t,this.saveImpactStats(t)}),n(()=>{let t={treesPlanted:500,familiesBenefited:50,communitiesServed:10,hectaresRestored:0,description:"",highlight1:"",highlight2:"",highlight3:""};return this.impactStatsCache=t,this.saveImpactStats(t),r(t)})).subscribe()}getImpactStats(){return this.impactStatsCache||{treesPlanted:500,familiesBenefited:50,communitiesServed:10,hectaresRestored:0,description:"",highlight1:"",highlight2:"",highlight3:""}}updateImpactStats(e){return this.http.put(`${c}/impact`,e).pipe(o(t=>{this.impactStatsCache=t,this.saveImpactStats(t)}),n(()=>(localStorage.setItem(this.IMPACT_KEY,JSON.stringify(e)),this.impactStatsCache=e,r(e))))}saveImpactStats(e){localStorage.setItem(this.IMPACT_KEY,JSON.stringify(e))}static \u0275fac=function(t){return new(t||l)};static \u0275prov=v({token:l,factory:l.\u0275fac,providedIn:"root"})};export{g as a};
